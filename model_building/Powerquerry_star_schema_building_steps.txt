â­ What is a Star Schema (Simple Explanation)

Think of it like this:

             Dim_Date
                 |
Dim_Vehicle â€” Fact_ncr_ride â€” Dim_Location
                 |
           Dim_Payment


The Fact table stays in the center.

Everything descriptive moves out.

ğŸ¯ STEP 1 â€” Identify FACT vs DIMENSION

From your dataset:

ğŸ”µ FACT TABLE (Numerical + transactional)

Keep in Fact_Rides:

Booking ID

BookingDateTime

Customer ID (foreign key)

Vehicle Type (foreign key)

Pickup Location (foreign key)

Drop Location (foreign key)

Booking Value

Ride Distance

Avg VTAT

Avg CTAT

Booking Status

Peak_Flag

Data_Validity_Flag

These represent events that happened.

ğŸŸ¢ DIMENSION TABLES (Descriptive Context)

We will now create them from your existing table.

ğŸš€ HOW TO CREATE DIMENSION TABLES (Step-by-Step)

We DO NOT manually type them.

We extract them from your cleaned table.

imp: First copy the cleaned tabel ok like("ncr_rides_clean(copy)") .Then from that copied table start creating references like dim location ,dim payment etc 
Then only we can able to merge these dim refrenced table from copied to original Fact_ncr_rides tabble .(this name is changed from ncr_rides_clean to fact_ncr_rides)

ğŸŸ¢ 1ï¸âƒ£ CREATE Dim_Date (Most Important)
Step:

Go to Power Query

Right-click Fact_Rides_Clean

Reference (NOT duplicate)

Rename â†’ Dim_Date

Now:

Keep only:

BookingDateTime

Booking_Hour

Day_Name

Day_Type

Month_Name

Then:

Remove duplicates

Now you have a proper date dimension.

ğŸš¨ Advanced (Better Approach)

Instead of using booking timestamps, create a proper Calendar Table in DAX later.

But for now, reference-based method is fine.

ğŸŸ¢ 2ï¸âƒ£ CREATE Dim_Vehicle

Right-click Fact table

Reference

Keep only:

Vehicle Type

Remove duplicates

Add Index Column â†’ Vehicle_ID

Now:

In Fact table, merge to bring Vehicle_ID

Remove Vehicle Type text

Keep only Vehicle_ID

Boom. You just normalized data.

ğŸŸ¢ 3ï¸âƒ£ CREATE Dim_Payment

Reference again:
Keep only:

Payment Method

Remove duplicates
Add:

Payment_ID

Merge back into Fact table.

ğŸŸ¢ 4ï¸âƒ£ CREATE Dim_Location

This is slightly smarter.

You have:

Pickup Location
Drop Location

Better approach:

Create a single location dimension.

Steps:

Reference Fact table

Keep Pickup Location â†’ rename as Location

Duplicate query

Keep Drop Location â†’ rename as Location

Append both queries

Remove duplicates

Now you have:
Dim_Location

Add:

Location_ID

Merge back into Fact table:

Pickup â†’ Pickup_Location_ID

Drop â†’ Drop_Location_ID

This is proper modeling.


ğŸŸ¢ 5ï¸âƒ£ CREATE Dim_CancellationReason

Reference table
Keep:

Reason for cancelling by Customer

Driver Cancellation Reason

Unpivot columns
Rename as:

Cancellation_Reason

Remove nulls
Remove duplicates

Add:

Reason_ID

ğŸ§± FINAL MODEL STRUCTURE
â­ Fact_ncr_ride

Booking_ID
Date_ID
Vehicle_ID
Payment_ID
Pickup_Location_ID
Drop_Location_ID
Booking Value
Ride Distance
VTAT
CTAT

Status Flags

â­ Dimensions

Dim_Date

Dim_Vehicle

Dim_Payment

Dim_Location

Dim_CancellationReason

>>We will now:

Merge ALL dimensions back into Fact
Bring only surrogate keys
Remove descriptive columns from Fact
Then create relationships

No shortcuts.
ğŸ§± BEFORE WE START

You must already have created:

Dim_Vehicle (Vehicle_ID, Vehicle Type)

Dim_Payment (Payment_ID, Payment Method)

Dim_Location (Location_ID, Location)

Dim_Date (if using reference-based method)

(Optional) Dim_CancellationReason

Each dimension must:

Have an Index column (ID)
Have no duplicates
Have clean values

Now we merge.

Go to:

ğŸ‘‰ Home â†’ Transform Data
(Open Power Query Editor)

ğŸŸ¢ MERGE 1 â€” Dim_Vehicle into Fact
Step 1

Click Fact_Rides_Clean

Step 2

Home â†’ Merge Queries

Step 3

Merge Window Opens

Top Table:
Fact_Rides_Clean

Bottom Table:
Dim_Vehicle

Step 4

Click:
Fact_Rides_Clean[Vehicle Type]

Then:
Dim_Vehicle[Vehicle Type]

(Columns must match exactly)

Step 5

Join Type:
ğŸ‘‰ Left Outer (default)
Keep all rows from Fact.

Click OK.

Step 6 â€” Expand

Youâ€™ll see a new column:
Dim_Vehicle

Click the expand icon.

Select ONLY:
â˜‘ Vehicle_ID

Uncheck:
â˜‘ Use original column name as prefix

Click OK.

Step 7 â€” Clean Fact

Now in Fact table:

You have:

Vehicle Type

Vehicle_ID

Delete:
âŒ Vehicle Type

Keep:
âœ… Vehicle_ID

Done.

ğŸŸ¢ MERGE 2 â€” Dim_Payment into Fact

Same exact process.

Match:

Fact_Rides_Clean[Payment Method]
with
Dim_Payment[Payment Method]

Expand:
â˜‘ Payment_ID only

Delete:
âŒ Payment Method

Keep:
âœ… Payment_ID

ğŸŸ¢ MERGE 3 â€” Dim_Location (IMPORTANT â€” TWO MERGES)

Because you have:

Pickup Location

Drop Location

We need TWO foreign keys.

ğŸ”¹ Merge A â€” Pickup Location

Merge:
Fact[Pickup Location]
with
Dim_Location[Location]

Expand:
â˜‘ Location_ID

Rename column to:
ğŸ‘‰ Pickup_Location_ID

Delete:
âŒ Pickup Location

ğŸ”¹ Merge B â€” Drop Location

Merge:
Fact[Drop Location]
with
Dim_Location[Location]

Expand:
â˜‘ Location_ID

Rename column to:
ğŸ‘‰ Drop_Location_ID

Delete:
âŒ Drop Location

ğŸŸ¢ MERGE 4 â€” Dim_Date (If You Created It via Reference)

If Dim_Date was created from Fact:

Better approach:

Instead of merging DateTime,
create a proper Date table later using DAX.

For now:

You can keep BookingDateTime in Fact
and connect later.

No need to merge Date dimension.



ğŸ§¼ FINAL FACT TABLE SHOULD LOOK LIKE THIS

Fact_Rides_Clean:

Booking_ID
BookingDateTime
Customer_ID
Vehicle_ID
Payment_ID
Pickup_Location_ID
Drop_Location_ID
Booking Value
Ride Distance
Avg VTAT
Avg CTAT
Booking Status
Peak_Flag
Data_Validity_Flag

Other numeric fields

NO descriptive text columns.

Thatâ€™s proper normalization.

ğŸš¨ VERY IMPORTANT CHECK

After each merge:

Row count must NOT change

No null IDs created

If null IDs exist â†’ category mismatch problem

Fix before continuing.

ğŸ FINAL STEP

Click:

ğŸ‘‰ Close & Apply

Wait for model to load.